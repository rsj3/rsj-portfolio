var _A={c:320,getTitle:function(d){var b=$(d),a=$("#title-link").text(),c=b?b.find(".page-permalink").text():"";if(c){a+=" / "+c}return a},scrollTo:function(b){var a=typeof b==="object"?$(b).offset().top:b,c=Math.abs($(document).scrollTop()-a)*0.16+160;$("html, body").animate({scrollTop:a},c,"easeInOutQuart")},resizeContainer:function(){var a=$(window).width(),b=parseInt(a/this.c,10);$("#outer-container").width(b*this.c)},pathOf:function(a){var b=purl(a);return b.attr("query").length?b.attr("path")+"?"+b.attr("query"):b.attr("path")},updatePage:function(c,g,j,e){var d=0,a=$("#page-wrapper"),b=a.offset(),k=a.find(".page-content"),l=$('<div class="page-content" style="display: none;"></div>').append(c);var f=$();l.find(".gallery").each(function(){f=f.add($(this).find(".gallery-image").eq(0))});f.imagesLoaded(function(){a.css({height:a.height()+"px"});a.append(l);if(l.is(":not(:empty)")){if(k.is(":not(:empty)")){l.fadeIn({delay:200,easing:"linear"})}else{l.show()}_A.scrollTo($("#page-wrapper"))}k.css({position:"absolute",left:"0px",top:"0px",width:k.width()});k.fadeOut({delay:200,easing:"linear",complete:function(){$(this).remove()}});l.find(".gallery.auto").each(function(){var m=$(this);if(m.find(".gallery-image").length>1){if(isTouch()){m.TouchGallery()}else{m.FadeGallery()}}});l.find(".gallery.touch").each(function(){var m=$(this);if(m.find(".gallery-image").length>1){m.TouchGallery()}});l.find(".gallery.fade").each(function(){var m=$(this);if(m.find(".gallery-image").length>1){m.FadeGallery()}});l.find(".page-description").find("h2").addClass("dontend");l.find(".page-description").columnize({width:_A.c-20});var h=new Function(g);h();d=l.outerHeight(true);if(d<=30){d=0}a.animate({height:d+"px"},500,"easeInOutQuart",function(){a.css({height:"auto"})});l.find(".page-close").show();if(j){document.title=j}$("#ajax-loader").fadeOut(400);$("#title-loader").fadeOut(400);l.sweet_justice();$(".snapshot").removeClass("faded");if($("#"+e).length){$("#"+e).addClass("faded")}})}};$(document).ready(function(){_A.$title=$("#title");_A.$tags=$("#tags");_A.$tag=$(".tag");_A.$options=$(".options");_A.$container=$("#snapshot-container");_A.$footer=$("#footer");_A.c=$("#outer-container").data("size-step")||_A.c;History=window.History,enableHistory=!$("#outer-container").hasClass("no-history");jQuery.fx.interval=22;jQuery.easing.def="easeOutQuint";$(".sort-option").pngFix();$(".snapshot").addClass("invis1");_A.$tag.addClass("active").filter("#snapshot").addClass("current");$(".noselect").disableSelection();_A.$options.show().data("fadeout",setTimeout(function(){_A.$options.fadeTo(400,0.2)},2600));_A.$tags.mouseenter(function(){clearTimeout(_A.$options.data("fadeout"));_A.$options.fadeTo(400,1)});_A.$tags.mouseleave(function(){_A.$options.data("fadeout",setTimeout(function(){_A.$options.fadeTo(400,0.2)},800))});_A.$tags.delegate(".tag","click",function(d){$this=$(this);_id=this.id;$(".nest:not(."+_id+"-nest)").slideUp(240);$(".parent-is-"+_id).each(function(){var e=$(this);if(e.children().length>1){e.slideDown(240)}});_A.$tag.removeClass("active").removeClass("current");$("."+_id+"-tag").addClass("active");$this.addClass("current");var c="."+_id;if(!$this.hasClass("base")){c+=":not( .hidden.leaf )"}$(".snapshot").not(c).addClass("nosort").fadeOut(400);$(c).removeClass("nosort").not(":visible").addClass("noanim").fadeIn(400);_A.$container.freetile("layout",{animate:true,selector:".snapshot:not(.nosort)"});$(".snapshot").removeClass("noanim")});_A.$container.delegate(".base","click",function(d){d.preventDefault();var c=this.id,f=c.substring(2);_A.$tags.find("#"+f).trigger("click");_A.scrollTo(_A.$tags)});_A.$container.delegate(".snapshot","mouseenter",function(){$(this).find("img").stop(true,true).animate({opacity:0.8},200)});_A.$container.delegate(".snapshot","mouseleave",function(){$(this).find("img").stop(true,true).animate({opacity:1},400)});$(".goto-top").click(function(c){c.preventDefault();_A.scrollTo(0);return false});$(".snapshot").each(function(c){$(this).prepend('<div class="projectCat invis1">'+c+"</div>")});var b=_A.$container.attr("sorting");$(".sort-option").removeClass("current");if(b=="date"){$("#sbd").addClass("current");$(".snapshot").tsort(".projectDate",{order:"desc"})}else{if(b=="shuffle"){$("#sbr").addClass("current");$(".snapshot:not(#control)").tsort("",{order:"rand"})}else{$("#sbc").addClass("current")}}_A.$container.prepend($(".featured"));$(".sort-option").click(function(){$(".sort-option").removeClass("current");$(this).addClass("current")});$("#sbd").click(function(){$(".snapshot:not(#control)").tsort(".projectDate",{order:"desc"});_A.$container.prepend($(".featured"));_A.$container.freetile("layout")});$("#sbc").click(function(){$(".snapshot:not(#control)").tsort(".projectCat",{order:"asc"});_A.$container.prepend($(".featured"));_A.$container.freetile("layout")});$("#sbr").click(function(){$(".snapshot:not(#control)").tsort("",{order:"rand"});_A.$container.prepend($(".featured"));_A.$container.freetile("layout")});bindEvent(document,"keyup",function(c){if(c.keyCode==67){$("#sbc").trigger("click")}else{if(c.keyCode==68){$("#sbd").trigger("click")}else{if(c.keyCode==83){$("#sbr").trigger("click")}}}if(c.keyCode==67||c.keyCode==68||c.keyCode==83){clearTimeout(_A.$options.data("fadeout"));_A.$options.fadeTo(400,1);_A.$options.data("fadeout",setTimeout(function(){_A.$options.fadeTo(400,0.2)},800))}if(c.stopPropagation){c.stopPropagation()}},false);var a=".snapshot:not(.nosort, .hidden.leaf)";$(a).find(".projectThumb").imagesLoaded(function(){$("#outer-container").css({opacity:0,visibility:"visible"}).animate({opacity:1},600,function(){$(".snapshot").each(function(){var f=$(this),e=f.find(".projectThumb");if(e){var c=false;if($(this).is(":not(:visible)")){c=true}if(c){f.show()}var d=e.width();if(d>0){f.width(d)}if(c){f.hide()}}});_A.$container.freetile({selector:a,animate:true,elementDelay:36,callback:function(c){$(a).each(function(d){var e=$(this);setTimeout(function(){e.fadeIn(360).removeClass("invis1").css("display","")},600+40*d);_A.$footer.fadeIn(500)})},animationOptions:{duration:380,easing:"easeInOutExpo"}})})});$(window).resize(function(){var c=$(this);clearTimeout(c.data("rsz"));c.data("rsz",setTimeout(function(){_A.resizeContainer()},200))});_A.resizeContainer();$(".sweet-justice").sweet_justice();$(".gallery.auto").imagesLoaded(function(){$(".gallery.auto").each(function(){var c=$(this);if(c.find(".gallery-image").length>1){if(isTouch()){c.TouchGallery()}else{c.FadeGallery()}}})});$(".gallery.touch").imagesLoaded(function(){$(".gallery.touch").each(function(){var c=$(this);if(c.find(".gallery-image").length>1){c.TouchGallery()}})});$(".gallery.fade").imagesLoaded(function(){$(".gallery.fade").each(function(){var c=$(this);if(c.find(".gallery-image").length>1){c.FadeGallery()}})});$(".page-description").find("h2").addClass("dontend");$(".page-description").columnize({width:_A.c-20});if(enableHistory&&History&&History.enabled){History.replaceState({state:$(".page-content").html(),currentid:$(".faded").attr("id")},document.title,"");_A.$container.delegate(".snapshot.leaf:not(.no-history, .external-link)","click",function(f){var d=$(this),c=_A.pathOf(d.find(".snapshot-link").attr("href"));f.preventDefault();if(!d.hasClass("faded")){if(c){$("#ajax-loader").appendTo(d).fadeIn(260);$.get(c,{},function(j){var k=$(j),e=k.filter("script"),g="";for(i=0;i<e.length;i++){var h=e[i];if(h.id=="page-script"){g=h.text||h.textContent||h.innerHTML||"";break}}History.pushState({state:$(j).find(".page-content").html(),script:g,currentid:d.attr("id")},_A.getTitle(j),c)},"html")}}});$("#title-link.dynamic-link").click(function(d){var c=_A.pathOf($(this).attr("href")),f=_A.pathOf(window.location);d.preventDefault();if(c!=f){if(c.length==0){c="/"}$("#title-loader").fadeIn(240);$.get(c,{},function(e){History.pushState({state:$(e).find(".page-content").html(),currentid:""},_A.getTitle(e),c)},"html")}});$("#top-menu a.page-link").click(function(d){var c=_A.pathOf($(this).attr("href")),f=_A.pathOf(window.location);d.preventDefault();if(c!=f){$("#title-loader").fadeIn(240);$.get(c,{},function(e){History.pushState({state:$(e).find(".page-content").html(),currentid:""},_A.getTitle(e),c)},"html")}});$(".page-close").show();$("#page-wrapper").delegate(".page-close","click",function(f){var d=$(this),c=d.parent().attr("href");f.preventDefault();$("html, body").animate({scrollTop:0},400,"easeInOutQuart");History.pushState({state:"",currentid:""},_A.getTitle(),c)});History.Adapter.bind(window,"statechange",function(){var c=History.getState();_A.updatePage(c.data.state||"",c.data.script||"",c.title,c.data.currentid)})}if(typeof(_gaq)!="undefined"){$('a[rel="download"]').click(function(){_gaq.push(["_trackEvent","Downloads","Download",$(this).html()])});$('a[rel="link"]').click(function(){_gaq.push(["_trackEvent","Links","Link: "+$(this).html(),$(this).attr("href")])});History.Adapter.bind(window,"statechange",function(){var c=History.getState();_gaq.push(["_trackPageview",c.url])})}});$(window).load(function(){if($(".page-content").length){setTimeout(function(){var a=$("#page-wrapper");if($(document).scrollTop()<a.offset().top){_A.scrollTo(a)}},1200)}});$.fn.disableSelection=function(){return this.each(function(){$(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=function(){return false}})})};$.fn.pngFix=function(){if(!$.browser.msie||$.browser.version>=9){return $(this)}return $(this).each(function(){var a=$(this),b=a.attr("src");a.attr("src","/images/general/transparent.gif").css("filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',sizingMethod='crop',src='"+b+"')")})};Array.min=function(a){return Math.min.apply(Math,a)};jQuery.extend(jQuery.expr[":"],{reallyvisible:function(b){return !(jQuery(b).is(":hidden")||jQuery(b).parents(":hidden").length)&&(jQuery(b).css("visibility")=="visible")}});var purl=(function(m){var k={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},j=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],n={anchor:"fragment"},r={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},p=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g,q=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g;function l(d,a){var e=decodeURI(d),b=r[a||false?"strict":"loose"].exec(e),f={attr:{},param:{},seg:{}},c=14;while(c--){f.attr[j[c]]=b[c]||""}f.param.query={};f.param.fragment={};f.attr.query.replace(p,function(h,s,g){if(s){f.param.query[s]=g}});f.attr.fragment.replace(q,function(h,s,g){if(s){f.param.fragment[s]=g}});f.seg.path=f.attr.path.replace(/^\/+|\/+$/g,"").split("/");f.seg.fragment=f.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");f.attr.base=f.attr.host?f.attr.protocol+"://"+f.attr.host+(f.attr.port?":"+f.attr.port:""):"";return f}function o(a){var b=a.tagName;if(b!==m){return k[b.toLowerCase()]}return b}return(function(b,a){if(arguments.length===1&&b===true){a=true;b=m}a=a||false;b=b||window.location.toString();return{data:l(b,a),attr:function(c){c=n[c]||c;return c!==m?this.data.attr[c]:this.data.attr},param:function(c){return c!==m?this.data.param.query[c]:this.data.param.query},fparam:function(c){return c!==m?this.data.param.fragment[c]:this.data.param.fragment},segment:function(c){if(c===m){return this.data.seg.path}else{c=c<0?this.data.seg.path.length+c:c-1;return this.data.seg.path[c]}},fsegment:function(c){if(c===m){return this.data.seg.fragment}else{c=c<0?this.data.seg.fragment.length+c:c-1;return this.data.seg.fragment[c]}}}})})(jQuery);function bindEvent(c,a,b){if(c.addEventListener){c.addEventListener(a,b,false)}else{if(c.attachEvent){c.attachEvent("on"+a,b)}}}function isTouch(){return !!("ontouchstart" in window)}(function(a){a.fn.hoverIntent=function(l,k){var m={sensitivity:7,interval:100,timeout:0};m=a.extend(m,k?{over:l,out:k}:l);var o,n,h,d;var e=function(f){o=f.pageX;n=f.pageY};var c=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);if((Math.abs(h-o)+Math.abs(d-n))<m.sensitivity){a(f).unbind("mousemove",e);f.hoverIntent_s=1;return m.over.apply(f,[g])}else{h=o;d=n;f.hoverIntent_t=setTimeout(function(){c(g,f)},m.interval)}};var j=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);f.hoverIntent_s=0;return m.out.apply(f,[g])};var b=function(p){var g=jQuery.extend({},p);var f=this;if(f.hoverIntent_t){f.hoverIntent_t=clearTimeout(f.hoverIntent_t)}if(p.type=="mouseenter"){h=g.pageX;d=g.pageY;a(f).bind("mousemove",e);if(f.hoverIntent_s!=1){f.hoverIntent_t=setTimeout(function(){c(g,f)},m.interval)}}else{a(f).unbind("mousemove",e);if(f.hoverIntent_s==1){f.hoverIntent_t=setTimeout(function(){j(g,f)},m.timeout)}}};return this.bind("mouseenter",b).bind("mouseleave",b)}})(jQuery);(function(a){a.fn.TouchGallery=function(){var h=0,p=a(this),u="",j="",n=p.find(".gallery-image"),o=n.length,v="",m="",s="",t=p.data("slideinterval")||0,l="",c="",d={},r=function(){k(h+1,true)},e=function(){k(h-1,true)},k=function(w,x){q(w,x)},q=function(w,y){var z=w+1;if(y){u.stop(true,true).animate({marginLeft:(z*j.width())*-1+"px"},{duration:360,queue:false,complete:function(){if(w<0){u.css({marginLeft:((o-2)*j.width())*-1+"px"})}else{if(w>o-3){u.css({marginLeft:(j.width())*-1+"px"})}}}});j.stop(true,true).animate({height:b(z)+"px"},{duration:360,queue:false})}else{if(w<0){u.css({marginLeft:(o-3)*j.width()*-1+"px"})}else{if(w>o-3){u.css({marginLeft:j.width()*-1+"px"})}else{u.css({marginLeft:(z)*j.width()*-1+"px"})}}j.css({height:b(z)+"px"})}if(w<0){h=o-3}else{if(w>o-3){h=0}else{h=w}}if(s){var x=(h+1)+" / "+(o-2),B=n.eq(h+1).data("title"),A=n.eq(h+1).data("description");captionContent=x;if(B){captionContent+=" &mdash; "+B}if(A){captionContent+=" &mdash; "+A}s.find("div").html(captionContent)}},b=function(w){return j.find("img")[w].height},g=function(w){if(!w){v.stop(true,true).fadeIn(300).animate({left:"0"},{duration:300,queue:false});m.stop(true,true).fadeIn(300).animate({right:"0"},{duration:300,queue:false})}else{v.stop(true,true).fadeOut(500).animate({left:"-20px"},{duration:500,queue:false});m.stop(true,true).fadeOut(500).animate({right:"-20px"},{duration:500,queue:false})}},f=function(w){if(w&&t>0){l=setInterval(function(){m.trigger("click")},t*1000)}else{clearTimeout(l)}};p.append(n.first().clone());p.prepend(n.eq(o-1).clone());n=p.find(".gallery-image");o+=2;if(!p.find(".image-wrapper").length){n.wrapAll("<div class='image-wrapper'><div class='image-holder'></div></div>")}u=p.find(".image-holder");j=p.find(".image-wrapper");u.width(1000000);n.width(j.width());n.find("img").css({"max-width":"100%",height:"auto"});n.css({"float":"left",margin:"0px"});p.addClass("dynamic-gallery");if(!p.find(".prev").length){p.prepend('<div class="gallery-controls"><a class="prev"></a><a class="next"></a></div>')}p.append('<div class="gallery-caption"><div></div></div>');s=p.find(".gallery-caption");v=p.find(".prev");m=p.find(".next");k(0,false);f(true);m.click(function(w){w.preventDefault();w.stopPropagation();r();this.blur();d.touched=false;return false});v.click(function(w){w.preventDefault();w.stopPropagation();e();this.blur();d.touched=false;return false});n.click(function(w){w.preventDefault();w.stopPropagation();if(!d.touched){r();this.blur()}else{d.touched=false}return false});p.hoverIntent(function(){clearTimeout(c);f(false);g()},function(){c=setTimeout(function(){g(true)},800);f(true)});c=setTimeout(function(){g(true)},1200);a(window).resize(function(){clearTimeout(j.data("resize-event"));j.data("resize-event",setTimeout(function(){n.css("width",j.width());j.css("height",b(h+1)+"px");u.css("marginLeft",((h+1)*j.width())*-1+"px")},200))});bindEvent(document,"keydown",function(w){if(w.keyCode==37){v.addClass("pressed")}else{if(w.keyCode==39){m.addClass("pressed")}}if(w.stopPropagation){w.stopPropagation()}},false);bindEvent(document,"keyup",function(w){if(w.keyCode==37){e();v.removeClass("pressed")}else{if(w.keyCode==39){r();m.removeClass("pressed")}}if(w.stopPropagation){w.stopPropagation()}},false);p.bind("touchstart",function(x){d.iOS=/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1;var w=x.touches||x.originalEvent.touches;d.origin={x:w[0].pageX,y:w[0].pageY};f(false);d.touchDragging=true}).bind("touchmove",function(x){var w=x.touches||x.originalEvent.touches;if(d.touchDragging&&w[0]&&w[0].pageX){if(!d.iOS){x.preventDefault();d.deltaY=w[0].pageY-d.origin.y;window.scrollBy(0,-d.deltaY)}d.deltaX=w[0].pageX-d.origin.x;u.css({marginLeft:((h+1)*j.width()*-1+d.deltaX)+"px"})}}).bind("touchend",function(w){if(d.deltaX<-40){g(true);r()}else{if(d.deltaX>40){g(true);e()}else{k(h,true)}}d.deltaX=0;d.touchDragging=false;d.touched=true;f(true);return false})}})(jQuery);(function(a){a.fn.FadeGallery=function(){var g=0,o=a(this),h="",m=o.find(".gallery-image"),n=m.length,t="",l="",s=o.data("slideinterval")||0,k="",c="",r="",q=function(){j(g+1,true)},d=function(){j(g-1,true)},j=function(v,u){if(v>=n){v=0}else{if(v<0){v=n-1}}p(v,u)},p=function(v,u){var x=u?"animate":"css";a(m[g]).stop(true,true).fadeOut(360);a(m[v]).stop(true,true).fadeIn(360);h[x]({height:b(v)+"px"},{duration:360,queue:false});g=v;if(r){var w=(g+1)+" / "+n,z=m.eq(g+1).data("title"),y=m.eq(g).data("description");captionContent=w;if(z){captionContent+=" &mdash; "+z}if(y){captionContent+=" &mdash; "+y}r.find("div").html(captionContent)}},b=function(u){return h.find("img")[u].height},f=function(u){if(!u){t.stop(true,true).fadeIn(300).animate({left:"0"},{duration:300,queue:false});l.stop(true,true).fadeIn(300).animate({right:"0"},{duration:300,queue:false})}else{t.stop(true,true).fadeOut(500).animate({left:"-20px"},{duration:500,queue:false});l.stop(true,true).fadeOut(500).animate({right:"-20px"},{duration:500,queue:false})}},e=function(u){if(u&&s>0){k=setInterval(function(){l.trigger("click")},s*1000)}else{clearTimeout(k)}};if(!o.find(".image-wrapper").length){m.wrapAll("<div class='image-wrapper'></div>")}h=o.find(".image-wrapper");h.css("position","relative");m.width(h.width());m.find("img").css({"max-width":"100%",height:"auto"});m.css({position:"absolute",width:"100%",left:"0px",top:"0px",margin:"0px"});o.addClass("dynamic-gallery");m.hide();if(!o.find(".prev").length){o.prepend('<div class="gallery-controls"><a class="prev"></a><a class="next"></a></div>')}o.append('<div class="gallery-caption"><div></div></div>');r=o.find(".gallery-caption");t=o.find(".prev");l=o.find(".next");j(0,false);e(true);l.click(function(u){u.preventDefault();u.stopPropagation();q();this.blur();return false});t.click(function(u){u.preventDefault();u.stopPropagation();d();this.blur();return false});m.click(function(u){u.preventDefault();u.stopPropagation();q();this.blur();return false});a(window).resize(function(){clearTimeout(h.data("resize-event"));h.data("resize-event",setTimeout(function(){m.css({width:h.width()});h.css({height:b(g)+"px"})},200))});o.hoverIntent(function(){clearTimeout(c);e(false);f()},function(){c=setTimeout(function(){f(true)},800);e(true)});c=setTimeout(function(){f(true)},1200);bindEvent(document,"keydown",function(u){if(u.keyCode==37){t.addClass("pressed")}else{if(u.keyCode==39){l.addClass("pressed")}}if(u.stopPropagation){u.stopPropagation()}},false);bindEvent(document,"keyup",function(u){if(u.keyCode==37){d();t.removeClass("pressed")}else{if(u.keyCode==39){q();l.removeClass("pressed")}}if(u.stopPropagation){u.stopPropagation()}},false)}})(jQuery);